	.data
default_str: .asciiz ""
Object: .asciiz "Object"
IO: .asciiz "IO"
String: .asciiz "String"
Int: .asciiz "Int"
Bool: .asciiz "Bool"
C: .asciiz "C"
D: .asciiz "D"
Main: .asciiz "Main"
A: .asciiz "A"
B: .asciiz "B"
data_0: .asciiz "Abort called from class "
data_1: .asciiz "
"
data_2: .asciiz "Substring out of range"
data_3: .asciiz "C: Hello world
"
data_4: .asciiz "(73,0) - RuntimeError: Dispatch on void
"
data_5: .asciiz "D: Hello world
"
data_6: .asciiz "(84,0) - RuntimeError: Dispatch on void
"
data_7: .asciiz "(95,0) - RuntimeError: Dispatch on void
"
data_8: .asciiz "(96,0) - RuntimeError: Dispatch on void
"
data_9: .asciiz "(97,0) - RuntimeError: Dispatch on void
"
data_10: .asciiz "(98,0) - RuntimeError: Dispatch on void
"
data_11: .asciiz "Done.
"
data_12: .asciiz "(99,0) - RuntimeError: Dispatch on void
"
data_13: .asciiz "A: Hello world
"
data_14: .asciiz "(55,0) - RuntimeError: Dispatch on void
"
data_15: .asciiz "B: Hello world
"
data_16: .asciiz "(64,0) - RuntimeError: Dispatch on void
"

type_name_table:
	.word	Object
	.word	IO
	.word	String
	.word	Int
	.word	Bool
	.word	C
	.word	D
	.word	Main
	.word	A
	.word	B

shells_table:
	.word	type_Object_shell
	.word	type_IO_shell
	.word	type_String_shell
	.word	type_Int_shell
	.word	type_Bool_shell
	.word	type_C_shell
	.word	type_D_shell
	.word	type_Main_shell
	.word	type_A_shell
	.word	type_B_shell

type_Object_dispatch:
	.word	 function_abort_at_Object
	.word	 function_type_name_at_Object
	.word	 function_copy_at_Object
	.word	 init_at_Object

type_Object_shell:
	.word	0
	.word	4
	.word	type_Object_dispatch


type_IO_dispatch:
	.word	 function_abort_at_Object
	.word	 function_type_name_at_Object
	.word	 function_copy_at_Object
	.word	 function_out_string_at_IO
	.word	 function_out_int_at_IO
	.word	 function_in_string_at_IO
	.word	 function_in_int_at_IO
	.word	 init_at_IO

type_IO_shell:
	.word	1
	.word	4
	.word	type_IO_dispatch


type_String_dispatch:
	.word	 function_abort_at_Object
	.word	 function_type_name_at_Object
	.word	 function_copy_at_Object
	.word	 function_length_at_String
	.word	 function_concat_at_String
	.word	 function_substr_at_String
	.word	 init_at_String

type_String_shell:
	.word	2
	.word	6
	.word	type_String_dispatch
	.word	default_str
	.word	type_Int_shell


type_Int_dispatch:
	.word	 function_abort_at_Object
	.word	 function_type_name_at_Object
	.word	 function_copy_at_Object
	.word	 init_at_Int

type_Int_shell:
	.word	3
	.word	5
	.word	type_Int_dispatch
	.word	0


type_Bool_dispatch:
	.word	 function_abort_at_Object
	.word	 function_type_name_at_Object
	.word	 function_copy_at_Object
	.word	 init_at_Bool

type_Bool_shell:
	.word	4
	.word	5
	.word	type_Bool_dispatch
	.word	0


type_C_dispatch:
	.word	 function_abort_at_Object
	.word	 function_type_name_at_Object
	.word	 function_copy_at_Object
	.word	 function_out_string_at_IO
	.word	 function_out_int_at_IO
	.word	 function_in_string_at_IO
	.word	 function_in_int_at_IO
	.word	 function_out_c_at_C

type_C_shell:
	.word	5
	.word	4
	.word	type_C_dispatch


type_D_dispatch:
	.word	 function_abort_at_Object
	.word	 function_type_name_at_Object
	.word	 function_copy_at_Object
	.word	 function_out_string_at_IO
	.word	 function_out_int_at_IO
	.word	 function_in_string_at_IO
	.word	 function_in_int_at_IO
	.word	 function_out_c_at_C
	.word	 function_out_d_at_D

type_D_shell:
	.word	6
	.word	4
	.word	type_D_dispatch


type_Main_dispatch:
	.word	 function_abort_at_Object
	.word	 function_type_name_at_Object
	.word	 function_copy_at_Object
	.word	 function_out_string_at_IO
	.word	 function_out_int_at_IO
	.word	 function_in_string_at_IO
	.word	 function_in_int_at_IO
	.word	 function_main_at_Main

type_Main_shell:
	.word	7
	.word	4
	.word	type_Main_dispatch


type_A_dispatch:
	.word	 function_abort_at_Object
	.word	 function_type_name_at_Object
	.word	 function_copy_at_Object
	.word	 function_out_a_at_A

type_A_shell:
	.word	8
	.word	5
	.word	type_A_dispatch
	.word	0


type_B_dispatch:
	.word	 function_abort_at_Object
	.word	 function_type_name_at_Object
	.word	 function_copy_at_Object
	.word	 function_out_a_at_A
	.word	 function_out_b_at_B

type_B_shell:
	.word	9
	.word	5
	.word	type_B_dispatch
	.word	0

	.text
	.globl main
main:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -8
	jal init_at_Main
	sw $v0, -16($fp)
	lw $a0, -16($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal function_main_at_Main
	sw $v0, -12($fp)
	addi $sp, $sp, 4
	li $v0, 0
	addi $sp, $sp, 8
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	li $v0, 10
	syscall
init_at_Object:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -4
	li $a0, 0
	sll $a0 $a0 2
	la $a1, shells_table
	addu $a1 $a1 $a0
	lw $a1, 0($a1)
	lw $a0, 4($a1)
	sll $a0 $a0 2
	jal malloc
	move $a2 $a0
	move $a0 $a1
	move $a1 $v0
	jal copy
	sw $v0, -12($fp)
	lw $v0, -12($fp)
	addi $sp, $sp, 4
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_abort_at_Object:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -4
	la $a0, data_0 + 0
	sw $a0, -12($fp)
	li $v0, 4
	lw $a0, -12($fp)
	syscall
	lw $t0, 0($fp)
	lw $a0, 0($t0)
	sll $a0 $a0 2
	la $a1, type_name_table
	addu $a0 $a0 $a1
	lw $a0, 0($a0)
	sw $a0, -12($fp)
	li $v0, 4
	lw $a0, -12($fp)
	syscall
	la $a0, data_1 + 0
	sw $a0, -12($fp)
	li $v0, 4
	lw $a0, -12($fp)
	syscall
	li $v0, 10
	syscall
	addi $sp, $sp, 4
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_type_name_at_Object:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -8
	lw $t0, 0($fp)
	lw $a0, 0($t0)
	sll $a0 $a0 2
	la $a1, type_name_table
	addu $a0 $a0 $a1
	lw $a0, 0($a0)
	sw $a0, -12($fp)
	lw $a0, -12($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_at_String
	sw $v0, -16($fp)
	addi $sp, $sp, 4
	lw $v0, -16($fp)
	addi $sp, $sp, 8
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_copy_at_Object:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -4
	lw $a0, 0($fp)
	lw $a0, 4($a0)
	sll $a0 $a0 2
	jal malloc
	move $a2 $a0
	move $a0 $a0
	move $a1 $v0
	jal copy
	sw $v0, -12($fp)
	lw $v0, -12($fp)
	addi $sp, $sp, 4
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_at_IO:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -4
	li $a0, 1
	sll $a0 $a0 2
	la $a1, shells_table
	addu $a1 $a1 $a0
	lw $a1, 0($a1)
	lw $a0, 4($a1)
	sll $a0 $a0 2
	jal malloc
	move $a2 $a0
	move $a0 $a1
	move $a1 $v0
	jal copy
	sw $v0, -12($fp)
	lw $v0, -12($fp)
	addi $sp, $sp, 4
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_out_string_at_IO:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -4
	lw $a0, 0($fp)
	lw $a1, 12($a0)
	sw $a1, -12($fp)
	li $v0, 4
	lw $a0, -12($fp)
	syscall
	lw $v0, 4($fp)
	addi $sp, $sp, 4
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_out_int_at_IO:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -4
	lw $a0, 0($fp)
	lw $a1, 12($a0)
	sw $a1, -12($fp)
	li $v0, 1
	lw $a0, -12($fp)
	syscall
	lw $v0, 4($fp)
	addi $sp, $sp, 4
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_in_string_at_IO:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -8
	jal read_str
	sw $v0, -12($fp)
	lw $a0, -12($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_at_String
	sw $v0, -16($fp)
	addi $sp, $sp, 4
	lw $v0, -16($fp)
	addi $sp, $sp, 8
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_in_int_at_IO:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -8
	li $v0, 5
	syscall
	sw $v0, -12($fp)
	lw $a0, -12($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_at_Int
	sw $v0, -16($fp)
	addi $sp, $sp, 4
	lw $v0, -16($fp)
	addi $sp, $sp, 8
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_at_String:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -12
	li $a0, 2
	sll $a0 $a0 2
	la $a1, shells_table
	addu $a1 $a1 $a0
	lw $a1, 0($a1)
	lw $a0, 4($a1)
	sll $a0 $a0 2
	jal malloc
	move $a2 $a0
	move $a0 $a1
	move $a1 $v0
	jal copy
	sw $v0, -12($fp)
	lw $a0, -12($fp)
	lw $a1, 0($fp)
	sw $a1, 12($a0)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, 0($fp)
	move $a0 $a0
	jal len
	sw $v0, -16($fp)
	lw $a0, 0($sp)
	addi $sp, $sp, 4
	lw $a0, -16($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_at_Int
	sw $v0, -20($fp)
	addi $sp, $sp, 4
	lw $a0, -12($fp)
	lw $a1, -20($fp)
	sw $a1, 16($a0)
	lw $v0, -12($fp)
	addi $sp, $sp, 12
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_length_at_String:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -4
	lw $a0, 0($fp)
	lw $a1, 16($a0)
	sw $a1, -12($fp)
	lw $v0, -12($fp)
	addi $sp, $sp, 4
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_concat_at_String:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -24
	lw $a0, 4($fp)
	lw $a1, 12($a0)
	sw $a1, -12($fp)
	lw $a0, 0($fp)
	lw $a1, 12($a0)
	sw $a1, -16($fp)
	lw $a0, 4($fp)
	lw $a1, 16($a0)
	sw $a1, -20($fp)
	lw $a0, 0($fp)
	lw $a1, 16($a0)
	sw $a1, -24($fp)
	lw $a0, -20($fp)
	lw $a1, 12($a0)
	sw $a1, -20($fp)
	lw $a0, -24($fp)
	lw $a1, 12($a0)
	sw $a1, -24($fp)
	lw $a0, -20($fp)
	lw $a1, -24($fp)
	add $a0 $a0 $a1
	sw $a0, -20($fp)
	lw $a0, -12($fp)
	lw $a1, -16($fp)
	lw $a2, -20($fp)
	jal concat
	sw $v0, -28($fp)
	lw $a0, -28($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_at_String
	sw $v0, -32($fp)
	addi $sp, $sp, 4
	lw $v0, -32($fp)
	addi $sp, $sp, 24
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_substr_at_String:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -32
	lw $a0, 8($fp)
	lw $a1, 12($a0)
	sw $a1, -36($fp)
	lw $a0, 4($fp)
	lw $a1, 12($a0)
	sw $a1, -16($fp)
	lw $a0, 0($fp)
	lw $a1, 12($a0)
	sw $a1, -20($fp)
	lw $a0, 8($fp)
	lw $a1, 16($a0)
	sw $a1, -24($fp)
	lw $a0, -20($fp)
	lw $a1, -16($fp)
	add $a0 $a0 $a1
	sw $a0, -28($fp)
	lw $a0, -24($fp)
	lw $a1, -28($fp)
	jal less
	sw $v0, -32($fp)
	lw $a0, -32($fp)
	bne $a0 $zero function_substr_at_String_error_label_0
	j function_substr_at_String_continue_label_1
	function_substr_at_String_error_label_0:
	li $v0, 4
	la $a0, data_2
	syscall
	li $v0, 10
	syscall
	function_substr_at_String_continue_label_1:
	lw $a0, -36($fp)
	lw $a1, -16($fp)
	lw $a2, -20($fp)
	jal substr
	sw $v0, -12($fp)
	lw $a0, -12($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_at_String
	sw $v0, -40($fp)
	addi $sp, $sp, 4
	lw $v0, -40($fp)
	addi $sp, $sp, 32
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_at_Int:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -4
	li $a0, 3
	sll $a0 $a0 2
	la $a1, shells_table
	addu $a1 $a1 $a0
	lw $a1, 0($a1)
	lw $a0, 4($a1)
	sll $a0 $a0 2
	jal malloc
	move $a2 $a0
	move $a0 $a1
	move $a1 $v0
	jal copy
	sw $v0, -12($fp)
	lw $a0, -12($fp)
	lw $a1, 0($fp)
	sw $a1, 12($a0)
	lw $v0, -12($fp)
	addi $sp, $sp, 4
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_at_Bool:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -4
	li $a0, 4
	sll $a0 $a0 2
	la $a1, shells_table
	addu $a1 $a1 $a0
	lw $a1, 0($a1)
	lw $a0, 4($a1)
	sll $a0 $a0 2
	jal malloc
	move $a2 $a0
	move $a0 $a1
	move $a1 $v0
	jal copy
	sw $v0, -12($fp)
	lw $a0, -12($fp)
	lw $a1, 0($fp)
	sw $a1, 12($a0)
	lw $v0, -12($fp)
	addi $sp, $sp, 4
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_out_c_at_C:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -28
	la $a0, data_3 + 0
	sw $a0, -16($fp)
	lw $a0, -16($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_at_String
	sw $v0, -20($fp)
	addi $sp, $sp, 4
	lw $a0, -20($fp)
	sw $a0, -12($fp)
	lw $a0, 0($fp)
	sw $a0, -28($fp)
	lw $a0, -28($fp)
	li $a1, 0
	jal equals
	sw $v0, -32($fp)
	lw $a0, -32($fp)
	bne $a0 $zero function_out_c_at_C_error_label_0
	j function_out_c_at_C_continue_label_1
	function_out_c_at_C_error_label_0:
	li $v0, 4
	la $a0, data_4
	syscall
	li $v0, 10
	syscall
	function_out_c_at_C_continue_label_1:
	lw $a0, -28($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -12($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -28($fp)
	lw $a1, 0($a0)
	sw $a1, -36($fp)
	lw $a0, -36($fp)
	la $a1, shells_table
	sll $a2 $a0 2
	addu $a1 $a1 $a2
	lw $a1, 0($a1)
	lw $a1, 8($a1)
	addiu $a1 $a1 12
	lw $a1, 0($a1)
	jalr $a1
	sw $v0, -24($fp)
	addi $sp, $sp, 8
	lw $v0, -24($fp)
	addi $sp, $sp, 28
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_at_C:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -8
	li $a0, 5
	sll $a0 $a0 2
	la $a1, shells_table
	addu $a1 $a1 $a0
	lw $a1, 0($a1)
	lw $a0, 4($a1)
	sll $a0 $a0 2
	jal malloc
	move $a2 $a0
	move $a0 $a1
	move $a1 $v0
	jal copy
	sw $v0, -12($fp)
	lw $a0, -12($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_attr_at_C
	sw $v0, -16($fp)
	addi $sp, $sp, 4
	lw $v0, -12($fp)
	addi $sp, $sp, 8
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_attr_at_C:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, 0
	addi $sp, $sp, 0
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_out_d_at_D:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -28
	la $a0, data_5 + 0
	sw $a0, -16($fp)
	lw $a0, -16($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_at_String
	sw $v0, -20($fp)
	addi $sp, $sp, 4
	lw $a0, -20($fp)
	sw $a0, -12($fp)
	lw $a0, 0($fp)
	sw $a0, -28($fp)
	lw $a0, -28($fp)
	li $a1, 0
	jal equals
	sw $v0, -32($fp)
	lw $a0, -32($fp)
	bne $a0 $zero function_out_d_at_D_error_label_0
	j function_out_d_at_D_continue_label_1
	function_out_d_at_D_error_label_0:
	li $v0, 4
	la $a0, data_6
	syscall
	li $v0, 10
	syscall
	function_out_d_at_D_continue_label_1:
	lw $a0, -28($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -12($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -28($fp)
	lw $a1, 0($a0)
	sw $a1, -36($fp)
	lw $a0, -36($fp)
	la $a1, shells_table
	sll $a2 $a0 2
	addu $a1 $a1 $a2
	lw $a1, 0($a1)
	lw $a1, 8($a1)
	addiu $a1 $a1 12
	lw $a1, 0($a1)
	jalr $a1
	sw $v0, -24($fp)
	addi $sp, $sp, 8
	lw $v0, -24($fp)
	addi $sp, $sp, 28
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_at_D:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -8
	li $a0, 6
	sll $a0 $a0 2
	la $a1, shells_table
	addu $a1 $a1 $a0
	lw $a1, 0($a1)
	lw $a0, 4($a1)
	sll $a0 $a0 2
	jal malloc
	move $a2 $a0
	move $a0 $a1
	move $a1 $v0
	jal copy
	sw $v0, -12($fp)
	lw $a0, -12($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_attr_at_D
	sw $v0, -16($fp)
	addi $sp, $sp, 4
	lw $v0, -12($fp)
	addi $sp, $sp, 8
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_attr_at_D:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -4
	lw $a0, 0($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_attr_at_C
	sw $v0, -12($fp)
	addi $sp, $sp, 4
	addi $sp, $sp, 4
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_main_at_Main:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -108
	jal init_at_A
	sw $v0, -20($fp)
	lw $a0, -20($fp)
	sw $a0, -16($fp)
	lw $a0, -16($fp)
	li $a1, 0
	jal equals
	sw $v0, -24($fp)
	lw $a0, -24($fp)
	bne $a0 $zero function_main_at_Main_error_label_0
	j function_main_at_Main_continue_label_1
	function_main_at_Main_error_label_0:
	li $v0, 4
	la $a0, data_7
	syscall
	li $v0, 10
	syscall
	function_main_at_Main_continue_label_1:
	lw $a0, -16($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -16($fp)
	lw $a1, 0($a0)
	sw $a1, -28($fp)
	lw $a0, -28($fp)
	la $a1, shells_table
	sll $a2 $a0 2
	addu $a1 $a1 $a2
	lw $a1, 0($a1)
	lw $a1, 8($a1)
	addiu $a1 $a1 12
	lw $a1, 0($a1)
	jalr $a1
	sw $v0, -12($fp)
	addi $sp, $sp, 4
	jal init_at_B
	sw $v0, -40($fp)
	lw $a0, -40($fp)
	sw $a0, -36($fp)
	lw $a0, -36($fp)
	li $a1, 0
	jal equals
	sw $v0, -44($fp)
	lw $a0, -44($fp)
	bne $a0 $zero function_main_at_Main_error_label_2
	j function_main_at_Main_continue_label_3
	function_main_at_Main_error_label_2:
	li $v0, 4
	la $a0, data_8
	syscall
	li $v0, 10
	syscall
	function_main_at_Main_continue_label_3:
	lw $a0, -36($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -36($fp)
	lw $a1, 0($a0)
	sw $a1, -48($fp)
	lw $a0, -48($fp)
	la $a1, shells_table
	sll $a2 $a0 2
	addu $a1 $a1 $a2
	lw $a1, 0($a1)
	lw $a1, 8($a1)
	addiu $a1 $a1 16
	lw $a1, 0($a1)
	jalr $a1
	sw $v0, -32($fp)
	addi $sp, $sp, 4
	jal init_at_C
	sw $v0, -60($fp)
	lw $a0, -60($fp)
	sw $a0, -56($fp)
	lw $a0, -56($fp)
	li $a1, 0
	jal equals
	sw $v0, -64($fp)
	lw $a0, -64($fp)
	bne $a0 $zero function_main_at_Main_error_label_4
	j function_main_at_Main_continue_label_5
	function_main_at_Main_error_label_4:
	li $v0, 4
	la $a0, data_9
	syscall
	li $v0, 10
	syscall
	function_main_at_Main_continue_label_5:
	lw $a0, -56($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -56($fp)
	lw $a1, 0($a0)
	sw $a1, -68($fp)
	lw $a0, -68($fp)
	la $a1, shells_table
	sll $a2 $a0 2
	addu $a1 $a1 $a2
	lw $a1, 0($a1)
	lw $a1, 8($a1)
	addiu $a1 $a1 28
	lw $a1, 0($a1)
	jalr $a1
	sw $v0, -52($fp)
	addi $sp, $sp, 4
	jal init_at_D
	sw $v0, -80($fp)
	lw $a0, -80($fp)
	sw $a0, -76($fp)
	lw $a0, -76($fp)
	li $a1, 0
	jal equals
	sw $v0, -84($fp)
	lw $a0, -84($fp)
	bne $a0 $zero function_main_at_Main_error_label_6
	j function_main_at_Main_continue_label_7
	function_main_at_Main_error_label_6:
	li $v0, 4
	la $a0, data_10
	syscall
	li $v0, 10
	syscall
	function_main_at_Main_continue_label_7:
	lw $a0, -76($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -76($fp)
	lw $a1, 0($a0)
	sw $a1, -88($fp)
	lw $a0, -88($fp)
	la $a1, shells_table
	sll $a2 $a0 2
	addu $a1 $a1 $a2
	lw $a1, 0($a1)
	lw $a1, 8($a1)
	addiu $a1 $a1 32
	lw $a1, 0($a1)
	jalr $a1
	sw $v0, -72($fp)
	addi $sp, $sp, 4
	la $a0, data_11 + 0
	sw $a0, -96($fp)
	lw $a0, -96($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_at_String
	sw $v0, -100($fp)
	addi $sp, $sp, 4
	lw $a0, -100($fp)
	sw $a0, -92($fp)
	lw $a0, 0($fp)
	sw $a0, -108($fp)
	lw $a0, -108($fp)
	li $a1, 0
	jal equals
	sw $v0, -112($fp)
	lw $a0, -112($fp)
	bne $a0 $zero function_main_at_Main_error_label_8
	j function_main_at_Main_continue_label_9
	function_main_at_Main_error_label_8:
	li $v0, 4
	la $a0, data_12
	syscall
	li $v0, 10
	syscall
	function_main_at_Main_continue_label_9:
	lw $a0, -108($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -92($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -108($fp)
	lw $a1, 0($a0)
	sw $a1, -116($fp)
	lw $a0, -116($fp)
	la $a1, shells_table
	sll $a2 $a0 2
	addu $a1 $a1 $a2
	lw $a1, 0($a1)
	lw $a1, 8($a1)
	addiu $a1 $a1 12
	lw $a1, 0($a1)
	jalr $a1
	sw $v0, -104($fp)
	addi $sp, $sp, 8
	lw $v0, -104($fp)
	addi $sp, $sp, 108
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_at_Main:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -8
	li $a0, 7
	sll $a0 $a0 2
	la $a1, shells_table
	addu $a1 $a1 $a0
	lw $a1, 0($a1)
	lw $a0, 4($a1)
	sll $a0 $a0 2
	jal malloc
	move $a2 $a0
	move $a0 $a1
	move $a1 $v0
	jal copy
	sw $v0, -12($fp)
	lw $a0, -12($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_attr_at_Main
	sw $v0, -16($fp)
	addi $sp, $sp, 4
	lw $v0, -12($fp)
	addi $sp, $sp, 8
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_attr_at_Main:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, 0
	addi $sp, $sp, 0
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_out_a_at_A:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -32
	la $a0, data_13 + 0
	sw $a0, -16($fp)
	lw $a0, -16($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_at_String
	sw $v0, -20($fp)
	addi $sp, $sp, 4
	lw $a0, -20($fp)
	sw $a0, -12($fp)
	lw $a0, 0($fp)
	lw $a1, 12($a0)
	sw $a1, -32($fp)
	lw $a0, -32($fp)
	sw $a0, -28($fp)
	lw $a0, -28($fp)
	li $a1, 0
	jal equals
	sw $v0, -36($fp)
	lw $a0, -36($fp)
	bne $a0 $zero function_out_a_at_A_error_label_0
	j function_out_a_at_A_continue_label_1
	function_out_a_at_A_error_label_0:
	li $v0, 4
	la $a0, data_14
	syscall
	li $v0, 10
	syscall
	function_out_a_at_A_continue_label_1:
	lw $a0, -28($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -12($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -28($fp)
	lw $a1, 0($a0)
	sw $a1, -40($fp)
	lw $a0, -40($fp)
	la $a1, shells_table
	sll $a2 $a0 2
	addu $a1 $a1 $a2
	lw $a1, 0($a1)
	lw $a1, 8($a1)
	addiu $a1 $a1 12
	lw $a1, 0($a1)
	jalr $a1
	sw $v0, -24($fp)
	addi $sp, $sp, 8
	lw $v0, -24($fp)
	addi $sp, $sp, 32
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_at_A:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -8
	li $a0, 8
	sll $a0 $a0 2
	la $a1, shells_table
	addu $a1 $a1 $a0
	lw $a1, 0($a1)
	lw $a0, 4($a1)
	sll $a0 $a0 2
	jal malloc
	move $a2 $a0
	move $a0 $a1
	move $a1 $v0
	jal copy
	sw $v0, -12($fp)
	lw $a0, -12($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_attr_at_A
	sw $v0, -16($fp)
	addi $sp, $sp, 4
	lw $v0, -12($fp)
	addi $sp, $sp, 8
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_attr_at_A:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -4
	jal init_at_IO
	sw $v0, -12($fp)
	lw $a0, 0($fp)
	lw $a1, -12($fp)
	sw $a1, 12($a0)
	addi $sp, $sp, 4
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
function_out_b_at_B:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -32
	la $a0, data_15 + 0
	sw $a0, -16($fp)
	lw $a0, -16($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_at_String
	sw $v0, -20($fp)
	addi $sp, $sp, 4
	lw $a0, -20($fp)
	sw $a0, -12($fp)
	lw $a0, 0($fp)
	lw $a1, 12($a0)
	sw $a1, -32($fp)
	lw $a0, -32($fp)
	sw $a0, -28($fp)
	lw $a0, -28($fp)
	li $a1, 0
	jal equals
	sw $v0, -36($fp)
	lw $a0, -36($fp)
	bne $a0 $zero function_out_b_at_B_error_label_0
	j function_out_b_at_B_continue_label_1
	function_out_b_at_B_error_label_0:
	li $v0, 4
	la $a0, data_16
	syscall
	li $v0, 10
	syscall
	function_out_b_at_B_continue_label_1:
	lw $a0, -28($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -12($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	lw $a0, -28($fp)
	lw $a1, 0($a0)
	sw $a1, -40($fp)
	lw $a0, -40($fp)
	la $a1, shells_table
	sll $a2 $a0 2
	addu $a1 $a1 $a2
	lw $a1, 0($a1)
	lw $a1, 8($a1)
	addiu $a1 $a1 12
	lw $a1, 0($a1)
	jalr $a1
	sw $v0, -24($fp)
	addi $sp, $sp, 8
	lw $v0, -24($fp)
	addi $sp, $sp, 32
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_at_B:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -8
	li $a0, 9
	sll $a0 $a0 2
	la $a1, shells_table
	addu $a1 $a1 $a0
	lw $a1, 0($a1)
	lw $a0, 4($a1)
	sll $a0 $a0 2
	jal malloc
	move $a2 $a0
	move $a0 $a1
	move $a1 $v0
	jal copy
	sw $v0, -12($fp)
	lw $a0, -12($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_attr_at_B
	sw $v0, -16($fp)
	addi $sp, $sp, 4
	lw $v0, -12($fp)
	addi $sp, $sp, 8
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
init_attr_at_B:
	addi $sp, $sp, -4
	sw $ra, 0($sp)
	addi $sp, $sp, -4
	sw $fp, 0($sp)
	addi $fp, $sp, 8
	addi $sp, $sp, -4
	lw $a0, 0($fp)
	addi $sp, $sp, -4
	sw $a0, 0($sp)
	jal init_attr_at_A
	sw $v0, -12($fp)
	addi $sp, $sp, 4
	addi $sp, $sp, 4
	addi $fp, $sp, -8
	lw $fp, 0($sp)
	addi $sp, $sp, 4
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra

header_size = 12 #in bytes
header_size_slot = 0
header_next_slot = 4
header_reachable_slot = 8
alloc_size       = 2048
total_alloc_size =  2060 #alloc_size + header_size
neg_header_size = -12 #-header_size
free_list = 0
used_list = header_size
state_size = 4
stack_base = -4
init_alloc_size = 28 #(header_size*2) +  state_size
object_mark = -1
meta_data_object_size = 4   #in words
object_expanded = -2
reachable = 1
new_line = 10
str_size_treshold = 1024
int_type = 0
string_type = 0
type_number = 0

free_block:
    addiu $sp $sp -28
    sw $t0 0($sp)
    sw $t1 4($sp)
    sw $t2 8($sp)
    sw $a0 12($sp)
    sw $ra 16($sp)
    sw $t3 20($sp)
    sw $t4 24($sp)

    move $t0 $a0
    
    addiu $t1 $gp free_list        

    addiu $t3 $gp used_list         

free_block_loop_used_list:         
    beq $t4 $t0 free_block_loop_free_list
    move $t3 $t4
    j free_block_loop_used_list


free_block_loop_free_list:         
    lw $t2 header_next_slot($t1)
    beq $t2 $zero free_block_founded_prev
    bge $t2 $t0 free_block_founded_prev
    move $t1 $t2
    j free_block_loop_free_list

free_block_founded_prev:        
    # Remove the block from the used-list
    lw $t4 header_next_slot($t0)
    sw $t4 header_next_slot($t3)
    
    # Add the block to the free-list
    sw $t2 header_next_slot($t0)
    sw $t0 header_next_slot($t1)

free_block_end:
   
    move $a0 $t0
    jal expand_block
    move $a0 $t1
    jal expand_block

    lw $t0 0($sp)
    lw $t1 4($sp)
    lw $t2 8($sp)
    lw $a0 12($sp)
    lw $ra 16($sp)
    lw $t3 20($sp)
    lw $t4 24($sp)
    addiu $sp $sp 28

    jr $ra


expand_block:
    addiu $sp $sp -16
    sw $t0 0($sp)
    sw $t1 4($sp)
    sw $t2 8($sp)
    sw $t3 12($sp)

    
    addiu $t0 $gp free_list    

    beq $t0 $a0 expand_block_end  
    move $t0 $a0

   
    lw $t1 header_next_slot($t0)
    lw $t2 header_size_slot($t0)
    move $t3 $t2
    addiu $t2 $t2 header_size
    addu $t2 $t2 $t0
    beq $t2 $t1 expand_block_expand
    j expand_block_end

expand_block_expand:    
    lw $t2 header_size_slot($t1)
    addi $t2 $t2 header_size
    add $t2 $t2 $t3
    sw $t2 header_size_slot($t0)
    lw $t1 header_next_slot($t1)
    sw $t1 header_next_slot($t0)
    
expand_block_end:
    lw $t0 0($sp)
    lw $t1 4($sp)
    lw $t2 8($sp)
    lw $t3 12($sp)
    addiu $sp $sp 16

    jr $ra


extend_heap:
    addiu $sp $sp -12
    sw $a0 0($sp)
    sw $a1 4($sp)
    sw $t0 8($sp)

    
    li $v0 9
    addiu $a0 $a1 header_size
    syscall
    
    
    move $t0 $a1 
    sw $t0 header_size_slot($v0)
    sw $zero header_next_slot($v0)
    sw $zero header_reachable_slot($v0)

    
    lw $t0, 0($sp)
    sw $v0 header_next_slot($t0)

    move $a0 $t0
    lw $a1 4($sp)
    lw $t0 8($sp)
    addiu $sp $sp 12

    jr $ra


  
split_block:
    addiu $sp $sp -16
    sw $t0 0($sp)
    sw $t1 4($sp)
    sw $a0 8($sp)
    sw $a1 12($sp)

   
    lw $t0 header_size_slot($a0)
    bgt $a1 $t0 split_block_error_small
    
    
    sub $t0 $t0 $a1
    li $t1 header_size
    ble $t0 $t1 split_block_same_size

    
    addu $t0 $a0 $a1
    addiu $t0 $t0 header_size     

    #Update headers of the two blocks
    lw $t1 header_next_slot($a0)    
    sw $t1 header_next_slot($t0)
    sw $t0 header_next_slot($a0)

    lw $t1 header_size_slot($a0)    
    sub $t1 $t1 $a1

    addi $t1 $t1 neg_header_size
    sw $t1 header_size_slot($t0)
    sw $a1 header_size_slot($a0)
    move $v0 $a0
    j split_block_end

split_block_same_size:
    move $v0 $a0
    j split_block_end

split_block_error_small:
    j split_block_end

split_block_end:
    lw $t0 0($sp)
    lw $t1 4($sp)
    lw $a0 8($sp)
    lw $a1 12($sp)
    addiu $sp $sp 16

    jr $ra

malloc:
    move $v0 $zero
    addiu $sp $sp -28
    sw $t1 0($sp)
    sw $t0 4($sp)
    sw $a0 8($sp)
    sw $a1 12($sp)
    sw $ra 16($sp)
    sw $t2 20($sp)
    sw $t3 24($sp)
    
    addiu $t0 $gp free_list
    j malloc_loop

malloc_end:

    move $a0 $v0
    lw $a1 8($sp)                  
    jal split_block

    lw $t1 header_next_slot($v0)
    sw $t1 header_next_slot($t3)

    addiu $t1 $gp used_list
    lw $a0 header_next_slot($t1)

    sw $a0 header_next_slot($v0)
    sw $v0 header_next_slot($t1)
    
    addiu $v0 $v0 header_size

    lw $t3 24($sp)
    lw $t2 20($sp)
    lw $ra 16($sp)
    lw $a1 12($sp)
    lw $a0 8($sp)
    lw $t0 4($sp)
    lw $t1 0($sp)
    addiu $sp $sp 28

    jr $ra

malloc_loop:
    move $t2 $t0                        
    lw $t0 header_next_slot($t0)        
    beq $t0 $zero malloc_search_end     
    j malloc_check_valid_block

malloc_search_end:
    beq $v0 $zero malloc_alloc_new_block  
    j malloc_end

malloc_alloc_new_block:
    li $t1 alloc_size               
    move $t3 $t2
    move $a1 $a0                    
    move $a0 $t2                    
    bge $a1 $t1 malloc_big_block   
    li $a1 alloc_size         
    jal extend_heap
    
    j malloc_end

malloc_big_block:
    #addiu $a1 $a1 header_size              
    jal extend_heap
    j malloc_end



malloc_check_valid_block:
    lw $t1 header_size_slot($t0)      
    bge $t1 $a0 malloc_valid_block    
    j malloc_loop

malloc_valid_block:
    beq $v0 $zero malloc_first_valid_block  
    bge $t1 $v1 malloc_loop                 
    move $v0 $t0                        
    move $v1 $t1                        
    move $t3 $t2
    j malloc_loop


malloc_first_valid_block:
    move $v0 $t0                        
    move $v1 $t1                        
    move $t3 $t2 
    j malloc_loop


copy:
    addiu $sp $sp -16
    sw $a0 0($sp)
    sw $a1 4($sp)
    sw $a2 8($sp)
    sw $t0 12($sp)

copy_loop:
    beq $a2 $zero copy_end
    lw $t0 0($a0)
    sw $t0 0($a1)
    addiu $a0 $a0 4
    addiu $a1 $a1 4
    addi $a2 $a2 -4
    j copy_loop 

copy_end:
    lw $a0 0($sp)
    lw $a1 4($sp)
    lw $a2 8($sp)
    lw $t0 12($sp)
    addiu $sp $sp 16

    jr $ra


use_block:
    addiu $sp $sp -12
    sw $t0 0($sp)
    sw $t1 4($sp)
    sw $t2 8($sp)

    addiu $t0 $gp free_list

use_block_loop:
    move $t1 $t0
    lw $t0 header_next_slot($t0)
    beq $t0 $zero use_block_end
    beq $t0 $a0 use_block_founded
    j use_block_loop

use_block_founded:
    lw $t2 header_next_slot($t0)
    sw $t2 header_next_slot($t1)

    addiu $t1 $gp used_list
    lw $t2 header_next_slot($t1)
    sw $t0 header_next_slot($t1)
    sw $t2 header_next_slot($t0)

use_block_end:
    lw $t0 0($sp)
    lw $t1 4($sp)
    lw $t2 8($sp)
    addiu $sp $sp 12

    jr $ra
equals:
    beq $a0 $a1 equals_equal
    li $v0 0
    j equals_end
    
equals_equal:
    li $v0 1

equals_end:
    jr $ra



less_equal:
    ble $a0 $a1 less_equal_true
    li $v0 0
    j less_equal_end

less_equal_true:
    li $v0 1

less_equal_end:
    jr $ra


less:
    blt $a0 $a1 less_true
    li $v0 0
    j less_end

less_true:
    li $v0 1

less_end:
    jr $ra
len:
    addiu $sp $sp -8
    sw $t0 0($sp)
    sw $t1 4($sp)

    move $t0 $a0
    move $v0 $zero

len_loop:
    lb $t1 0($t0)
    beq $t1 $zero len_end
    addi $v0 $v0 1
    addiu $t0 $t0 1
    j len_loop

len_end:
    lw $t0 0($sp)
    lw $t1 4($sp)
    addiu $sp $sp 8

    jr $ra

concat:
    addiu $sp $sp -24
    sw $t0 0($sp)
    sw $t1 4($sp)
    sw $t2 8($sp)
    sw $a0 12($sp)
    sw $a1 16($sp)
    sw $ra 20($sp)

    move $t0 $a0
    move $t1 $a1


    addiu $a0 $a2 1
    li $t2 4
    div $a0 $t2
    mfhi $a0
    bne $a0 $zero concat_allign_size
    addiu $a0 $a2 1

concat_size_alligned:
    jal malloc
    move $t2 $v0
    j concat_copy_first_loop

concat_allign_size:
    sub $t2 $t2 $a0
    add $a0 $a2 $t2
    addiu $a0 $a0 1
    j concat_size_alligned

concat_copy_first_loop:
    lb $a0 0($t0)
    beq $a0 $zero concat_copy_second_loop
    sb $a0 0($t2)
    addiu $t0 $t0 1
    addiu $t2 $t2 1
    j concat_copy_first_loop

concat_copy_second_loop:
    lb $a0 0($t1)
    beq $a0 $zero concat_end
    sb $a0 0($t2)
    addiu $t1 $t1 1
    addiu $t2 $t2 1
    j concat_copy_second_loop

concat_end:
    sb $zero 0($t2)
    lw $t0 0($sp)
    lw $t1 4($sp)
    lw $t2 8($sp)
    lw $a0 12($sp)
    lw $a1 16($sp)
    lw $ra 20($sp)
    addiu $sp $sp 24

    jr $ra


substr:
    addiu $sp $sp -24
    sw $t0 0($sp)
    sw $t1 4($sp)
    sw $t2 8($sp)
    sw $t3 12($sp)
    sw $a0 16($sp)
    sw $ra 20($sp)

    move $t0 $a0
    li $t1 4
    addiu $t3 $a2 1
    div $t3 $t1
 
    mfhi $t2
    bne $t2 $zero substr_allign_size
    move $t1 $t3
    j substr_new_block

substr_allign_size:
    sub $t1 $t1 $t2
    add $t1 $t1 $t3

substr_new_block:
    move $a0 $t1
    jal malloc
    move $t3 $v0
    move $t1 $zero
    addu $t0 $t0 $a1

substr_copy_loop:
    beq $t1 $a2 substr_end
    lb $t2 0($t0)
    sb $t2 0($t3)
    addiu $t0 $t0 1
    addiu $t3 $t3 1
    addiu $t1 $t1 1
    j substr_copy_loop

substr_end:
    sb $zero 0($t3)
    lw $t0 0($sp)
    lw $t1 4($sp)
    lw $t2 8($sp)
    lw $t3 12($sp)
    lw $a0 16($sp)
    lw $ra 20($sp)
    addiu $sp $sp 24

    jr $ra


equal_str:
    addiu $sp $sp -16
    sw $t0 0($sp)
    sw $t1 4($sp)
    sw $t2 8($sp)
    sw $t3 12($sp)

    move $t0 $a0
    move $t1 $a1

equal_str_loop:
    lb $t2 0($t0)
    lb $t3 0($t1)
    bne $t2 $t3 equal_str_not_equal
    beq $t2 $zero equal_str_equal

    addiu $t0 $t0 1
    addiu $t1 $t1 1
    j equal_str_loop

equal_str_not_equal:
    move $v0 $zero
    j equal_str_end

equal_str_equal:
    li $v0 1

equal_str_end:
    lw $t0 0($sp)
    lw $t1 4($sp)
    lw $t2 8($sp)
    lw $t3 12($sp)
    addiu $sp $sp 16

    jr $ra
    
read_str:
    addiu $sp $sp -36
    sw $t0 0($sp)
    sw $t1 4($sp)
    sw $t2 8($sp)
    sw $t3 12($sp)
	sw $t4 16($sp)
	sw $t5 20($sp)
    sw $a0 24($sp)
    sw $a1 28($sp)
    sw $ra 32($sp)
	
    addiu $t0 $gp free_list
    move $t1 $zero
    move $t2 $t0

read_str_larger_block_loop:
    lw $t0 header_next_slot($t0)
    beq $t0 $zero read_str_reading
    lw $t3 header_size_slot($t0)
    bge $t1 $t3 read_str_larger_block_loop
    move $t1 $t3
    move $t2 $t0
    j read_str_larger_block_loop

read_str_reading:
    beq $t1 $zero read_str_new_block
    move $a1 $t1
    li $v0 8
    addiu $a0 $t2 header_size
    syscall
    move $t0 $a0
    move $t1 $zero

read_str_look_nl:
    lb $t2 0($t0)
    beq $t2 new_line read_str_nl_founded
    beq $t2 $zero read_str_zero_founded#read_str_no_nl
    addi $t1 $t1 1
    addi $t0 $t0 1
    j read_str_look_nl

read_str_zero_founded:
    blt $t1 $t3 read_str_nl_founded
    j read_str_no_nl

read_str_nl_founded:
    sb $zero 0($t0)
    addi $t1 $t1 1
	li $t2 4
	div $t1 $t2
	mfhi $t3
	beq $t3 $zero read_str_nl_founded_alligned
	sub $t2 $t2 $t3
	add $t1 $t1 $t2
read_str_nl_founded_alligned:
    move $a1 $t1
    addiu $a0 $a0 neg_header_size
    jal split_block
    jal use_block

    addiu $v0 $a0 header_size
	j read_str_end


read_str_no_nl:
	addi $t1 $t1 1
    blt $t1 str_size_treshold read_str_dup
	addi $t1 $t1 alloc_size
	j read_str_extend_heap
read_str_dup:
	sll $t1 $t1 1
read_str_extend_heap:
	move $a1 $t1
	move $t0 $a0
	addiu $a0 $gp free_list

read_str_last_block_loop:
	lw $t1 header_next_slot($a0)
	beq $t1 $zero read_str_last_block_founded
	lw $a0 header_next_slot($a0)
	j read_str_last_block_loop

read_str_last_block_founded:
	jal extend_heap
	jal expand_block
	lw $t1 header_next_slot($a0)
	bne $t1 $zero read_str_copy_prev
	move $t1 $a0

read_str_copy_prev:
	lw $t3 header_size_slot($t1)
	move $t2 $zero
	move $t5 $t1
	addiu $t1 $t1 header_size

read_str_copy_loop:
	lb $t4 0($t0)
	beq $t4 $zero read_str_copy_end
	sb $t4 0($t1)
	addi $t2 $t2 1
	addi $t0 $t0 1
	addi $t1 $t1 1
	j read_str_copy_loop

read_str_copy_end:
	sub $t3 $t3 $t2
	move $a0 $t1
	move $a1 $t3
	li $v0 8
	syscall
	move $t0 $a0
	move $t1 $t2
	addiu $a0 $t5 header_size
	j read_str_look_nl

	
read_str_end:
    lw $t0 0($sp)
    lw $t1 4($sp)
    lw $t2 8($sp)
    lw $t3 12($sp)
	lw $t4 16($sp)
	lw $t5 20($sp)
    lw $a0 24($sp)
    lw $a1 28($sp)
    lw $ra 32($sp)
    addiu $sp $sp 36

    jr $ra


read_str_new_block:
    addiu $t0 $gp free_list

read_str_new_block_search_last:
    lw $t1 header_next_slot($t0)
    beq $t1 $zero read_str_new_block_create
    move $t0 $t1
    j read_str_new_block_search_last

read_str_new_block_create:
    move $a0 $t0
    li $a1 alloc_size
    jal extend_heap
    jal expand_block
    lw $t2 header_next_slot($a0)
    beq $t2 $zero read_str_new_block_expanded
    lw $t1 header_size_slot($t2)
    j read_str_reading

read_str_new_block_expanded:
    move $t2 $a0
    lw $t1 header_size_slot($a0)
    j read_str_reading